{"version":3,"sources":["main.js"],"names":["imageDataFragment","canvas","document","getElementById","context","getContext","lineWidth","enabled","autoSetCanvasSize","canvasSize","window","onresize","width","documentElement","clientWidth","height","clientHeight","drawLine","x1","y1","x2","y2","beginPath","moveTo","lineTo","stroke","closePath","drawCircle","x","y","radius","arc","Math","PI","fill","listenToUser","using","lastPoint","undefined","body","ontouchstart","onmousedown","a","clientX","clientY","clearRect","onmousemove","newPoint","onmouseup","touches","ontouchmove","ontouchend","toggle","onclick","e","target","matches","toggleClose","classList","add","toggleOpen","remove","tools","style","display","clear","canvasHistory","step","back","go","download","compositeOperation","globalCompositeOperation","fillStyle","fillRect","imageData","toDataURL","putImageData","getImageData","createElement","appendChild","href","click","black","strokeStyle","red","green","blue","currentColor","value","onchange","range","addEventListener","preventDefault","passive"],"mappings":"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","file":"main.22ed5ac4.js","sourceRoot":"..\\src","sourcesContent":["var canvas = document.getElementById(\"canvas\");\r\nvar context = canvas.getContext(\"2d\");\r\nvar lineWidth = 5;\r\nvar enabled = false;\r\nvar imageDataFragment;\r\n\r\nautoSetCanvasSize(canvas);\r\n\r\nlistenToUser(canvas);\r\n\r\ntoggle.onclick = function(e) {\r\n  if (e.target.matches(\".open\")) {\r\n    toggleClose.classList.add(\"show\");\r\n    toggleOpen.classList.remove(\"show\");\r\n    tools.style.display = \"none\";\r\n  } else {\r\n    toggleClose.classList.remove(\"show\");\r\n    toggleOpen.classList.add(\"show\");\r\n    tools.style.display = \"block\";\r\n  }\r\n};\r\nclear.onclick = function() {\r\n  context.clearRect(0, 0, canvas.width, canvas.height);\r\n  canvasHistory = [];\r\n  step = -1;\r\n  back.classList.remove(\"active\");\r\n  go.classList.remove(\"active\");\r\n};\r\ndownload.onclick = function() {\r\n  var compositeOperation = context.globalCompositeOperation;\r\n  context.globalCompositeOperation = \"destination-over\";\r\n  context.fillStyle = \"#fff\";\r\n  context.fillRect(0, 0, canvas.width, canvas.height);\r\n  var imageData = canvas.toDataURL(\"image/png\");\r\n  context.putImageData(context.getImageData(0, 0, canvas.width, canvas.height),0,0);\r\n  context.globalCompositeOperation = compositeOperation;\r\n  var a = document.createElement(\"a\");\r\n  document.body.appendChild(a);\r\n  a.href = imageData;\r\n  a.download = \"myPaint\";\r\n  a.target = \"_blank\";\r\n  a.click();\r\n};\r\n\r\nblack.onclick = function() {\r\n  context.fillStyle = \"black\";\r\n  context.strokeStyle = \"black\";\r\n  black.classList.add(\"active\");\r\n  red.classList.remove(\"active\");\r\n  green.classList.remove(\"active\");\r\n  blue.classList.remove(\"active\");\r\n};\r\nred.onclick = function() {\r\n  context.fillStyle = \"red\";\r\n  context.strokeStyle = \"red\";\r\n  red.classList.add(\"active\");\r\n  green.classList.remove(\"active\");\r\n  blue.classList.remove(\"active\");\r\n  black.classList.remove(\"active\");\r\n};\r\ngreen.onclick = function() {\r\n  context.fillStyle = \"green\";\r\n  context.strokeStyle = \"green\";\r\n  green.classList.add(\"active\");\r\n  red.classList.remove(\"active\");\r\n  blue.classList.remove(\"active\");\r\n  black.classList.remove(\"active\");\r\n};\r\nblue.onclick = function() {\r\n  context.fillStyle = \"blue\";\r\n  context.strokeStyle = \"blue\";\r\n  blue.classList.add(\"active\");\r\n  green.classList.remove(\"active\");\r\n  red.classList.remove(\"active\");\r\n  black.classList.remove(\"active\");\r\n};\r\ncurrentColor.onclick = function(e) {\r\n  context.fillStyle = e.target.value;\r\n  context.strokeStyle = e.target.value;\r\n  blue.classList.remove(\"active\");\r\n  green.classList.remove(\"active\");\r\n  red.classList.remove(\"active\");\r\n  black.classList.remove(\"active\");\r\n};\r\ncurrentColor.onchange = function(e) {\r\n  context.fillStyle = e.target.value;\r\n  context.strokeStyle = e.target.value;\r\n  switch (e.target.value) {\r\n    case \"#000000\":\r\n      black.classList.add(\"active\");\r\n      break;\r\n    case \"#ff0000\":\r\n      red.classList.add(\"active\");\r\n      break;\r\n    case \"#008000\":\r\n      green.classList.add(\"active\");\r\n      break;\r\n    case \"#0000ff\":\r\n      blue.classList.add(\"active\");\r\n      break;\r\n  }\r\n};\r\nrange.onchange = function(e) {\r\n  lineWidth = e.target.value * 1;\r\n};\r\n\r\nfunction autoSetCanvasSize(canvas) {\r\n  canvasSize();\r\n  window.onresize = function() {\r\n    canvasSize();\r\n  };\r\n}\r\n\r\nfunction canvasSize() {\r\n  canvas.width = document.documentElement.clientWidth;\r\n  canvas.height = document.documentElement.clientHeight;\r\n}\r\n\r\nfunction drawLine(x1, y1, x2, y2) {\r\n  context.beginPath();\r\n  context.moveTo(x1, y1);\r\n  context.lineWidth = lineWidth;\r\n  context.lineTo(x2, y2);\r\n  context.stroke();\r\n  context.closePath();\r\n}\r\n\r\nfunction drawCircle(x, y, radius) {\r\n  context.beginPath();\r\n  context.arc(x, y, radius, 0, Math.PI * 2);\r\n  context.fill();\r\n}\r\n\r\nfunction listenToUser(canvas) {\r\n  var using = false;\r\n  var lastPoint = {\r\n    x: undefined,\r\n    y: undefined\r\n  };\r\n  //特性检测\r\n  if (document.body.ontouchstart === undefined) {\r\n    //非触屏设备\r\n    canvas.onmousedown = function(a) {\r\n      var x = a.clientX;\r\n      var y = a.clientY;\r\n      using = true;\r\n      if (enabled) {\r\n        clearRect(x, y);\r\n      } else {\r\n        lastPoint = {\r\n          x: x,\r\n          y: y\r\n        };\r\n      }\r\n    };\r\n    canvas.onmousemove = function(a) {\r\n      var x = a.clientX;\r\n      var y = a.clientY;\r\n      if (!using) {\r\n        return;\r\n      }\r\n      if (enabled) {\r\n        clearRect(x, y);\r\n      } else {\r\n        var newPoint = {\r\n          x: x,\r\n          y: y\r\n        };\r\n        drawCircle(x, y, lineWidth / 2);\r\n        drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y);\r\n        lastPoint = newPoint;\r\n      }\r\n    };\r\n    canvas.onmouseup = function() {\r\n      using = false;\r\n    };\r\n  } else {\r\n    //触屏设备\r\n    canvas.ontouchstart = function(a) {\r\n      var x = a.touches[0].clientX;\r\n      var y = a.touches[0].clientY;\r\n      using = true;\r\n      if (enabled) {\r\n        clearRect(x, y);\r\n      } else {\r\n        lastPoint = {\r\n          x: x,\r\n          y: y\r\n        };\r\n      }\r\n    };\r\n    canvas.ontouchmove = function(a) {\r\n      var x = a.touches[0].clientX;\r\n      var y = a.touches[0].clientY;\r\n      if (!using) {\r\n        return;\r\n      }\r\n      if (enabled) {\r\n        clearRect(x, y);\r\n      } else {\r\n        var newPoint = {\r\n          x: x,\r\n          y: y\r\n        };\r\n        drawCircle(x, y, lineWidth / 2);\r\n        drawLine(lastPoint.x, lastPoint.y, newPoint.x, newPoint.y);\r\n        lastPoint = newPoint;\r\n      }\r\n    };\r\n    canvas.ontouchend = function() {\r\n      using = false;\r\n    };\r\n  }\r\n}\r\ndocument.body.addEventListener(\r\n  \"touchmove\",\r\n  function(e) {\r\n    e.preventDefault();\r\n  },\r\n  { passive: false }\r\n);"]}